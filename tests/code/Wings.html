<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Wings of the Chandra PSF &#8212; MARX 5.5.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/marxwebtheme.css?v=c47e7066" />
    
    <script src="../../_static/documentation_options.js?v=947d29b4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MARX 5.5.3 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="On-axis PSF at different energies" href="CompMARXSAOTraceenergies.html" />
    <link rel="prev" title="Off-axis PSF" href="OffAxisPSF.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../std-parindex.html" title="MARX Parameter Index"
             >MARX Parameters</a> |</li>
        <li class="right" >
          <a href="CompMARXSAOTraceenergies.html" title="On-axis PSF at different energies"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="OffAxisPSF.html" title="Off-axis PSF"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MARX 5.5.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><strong>marx</strong> accuracy and testing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../listofcode.html" accesskey="U">List of code used to run tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Wings of the Chandra PSF</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following shows the code used to run this <strong>marx</strong> test. You can inspect
it and adapt it to your needs, but you cannot copy and paste it directly
because it depends on local <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> and other environment variables.
For example, we use a python function to manage the directory structure
for all the images generated by all the tests instead of giving the file
name directly to save images.</p>
</div>
<section id="wings-of-the-chandra-psf">
<span id="test-code-wings"></span><h1>Wings of the Chandra PSF<a class="headerlink" href="#wings-of-the-chandra-psf" title="Link to this heading">¶</a></h1>
<section id="ciao-obtain-spectrum-from-observed-data">
<h2>CIAO : Obtain spectrum from observed data<a class="headerlink" href="#ciao-obtain-spectrum-from-observed-data" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>asphist<span class="w"> </span><span class="nv">infile</span><span class="o">=</span>download/3662/primary/pcadf141954141N003_asol1.fits<span class="w"> </span><span class="nv">outfile</span><span class="o">=</span>obs.asp<span class="w"> </span><span class="nv">evtfile</span><span class="o">=</span>download/3662/primary/acisf03662N003_evt2.fits.gz<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
<span class="c1"># It would be more accuarte to use mkwarf.</span>
<span class="c1"># However, that&#39;s slower and for our purposes an approximate solution is good enough.</span>
mkarf<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span>ACIS-7<span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">outfile</span><span class="o">=</span>obs.arf<span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span>download/3662/primary/acisf03662N003_evt2.fits.gz<span class="w"> </span><span class="nv">asphistfile</span><span class="o">=</span>obs.asp<span class="w"> </span><span class="nv">sourcepixelx</span><span class="o">=</span><span class="m">4174</span><span class="w"> </span><span class="nv">sourcepixely</span><span class="o">=</span><span class="m">4043</span><span class="w"> </span><span class="nv">engrid</span><span class="o">=</span><span class="s2">&quot;0.3:8.0:0.1&quot;</span><span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">pbkfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">verbose</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">mode</span><span class="o">=</span>h<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># We have to use the same energy binning in energy space here that we used for the arf!</span>
<span class="c1"># So, first convert the PI to energy (to a precision that&#39;s good enough).</span>
dmtcalc<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS][sky=rotbox(3922.6168,3556.9146,12,512,332.71498)]&quot;</span><span class="w"> </span>evt2_with_energy.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;energy=(float)pi*0.0149&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;evt2_with_energy.fits[bin energy=.3:7.999:0.1]&quot;</span><span class="w"> </span>obs.spec<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic
dmcopy<span class="w"> </span><span class="s2">&quot;obs.arf[cols energ_lo,energ_hi,specresp]&quot;</span><span class="w"> </span>input_spec.fits<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmpaste<span class="w"> </span>input_spec.fits<span class="w"> </span><span class="s2">&quot;obs.spec[cols counts]&quot;</span><span class="w"> </span>input_spec_1.fits<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmtcalc<span class="w"> </span>input_spec_1.fits<span class="w"> </span>input_spec_2.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;flux=counts/((float)specresp * 0.0064*51927.014620006084)&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># devide by binwidth to turn the flux into a flux DENSITY for marx</span>
dmtcalc<span class="w"> </span>input_spec_2.fits<span class="w"> </span>input_spec_3.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;fluxdens=flux/0.1&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmcopy<span class="w"> </span><span class="s2">&quot;input_spec_3.fits[cols energ_hi,fluxdens]&quot;</span><span class="w"> </span><span class="s2">&quot;input_spec_marx.tbl[opt kernel=text/simple]&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmcopy<span class="w"> </span><span class="s2">&quot;input_spec_3.fits[cols energ_lo,energ_hi,flux]&quot;</span><span class="w"> </span><span class="s2">&quot;input_spec_saotrace.tbl[opt kernel=text/simple]&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># We now use a combination of some of the most obscure UNIX tools to</span>
<span class="c1"># bring the SAOTRACE input spectrum into the right format</span>
<span class="c1"># see http://cxc.harvard.edu/cal/Hrma/RDB/FileFormat.html</span>

<span class="c1"># Remove the leading &quot;#&quot; from the line with the column names</span>
awk<span class="w"> </span><span class="s1">&#39;{ sub(/\# ENERG_LO/,&quot;ENERG_LO&quot;); print }&#39;</span><span class="w"> </span>&lt;<span class="w"> </span>input_spec_saotrace.tbl<span class="w"> </span>&gt;<span class="w"> </span>input_spec_saotrace.temp
<span class="c1"># Then, replace spaces with tabs</span>
tr<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="se">\\</span>t<span class="w"> </span>&lt;<span class="w"> </span>input_spec_saotrace.temp<span class="w"> </span>&gt;<span class="w"> </span>input_spec_saotrace.rdb
</pre></div>
</div>
</section>
<section id="shell-unzip-fits-file">
<h2>shell : Unzip fits file.<a class="headerlink" href="#shell-unzip-fits-file" title="Link to this heading">¶</a></h2>
<p>MARX cannot read zipped fits files, so we need to unzip the .fits.gz asol
files that we downloaded from the archive. On the other hand, <a class="reference external" href="http://cxc.harvard.edu/ciao/">CIAO</a>
tools work on both zipped or unzipped files, so there is no need to
unzip all of them, just the files that MARX reads as input.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gunzip<span class="w"> </span>-f<span class="w"> </span>download/3662/primary/pcadf141954141N003_asol1.fits
</pre></div>
</div>
</section>
<section id="marx-set-marx-parameters-appropriate-for-observation">
<h2>marx : Set marx parameters appropriate for observation<a class="headerlink" href="#marx-set-marx-parameters-appropriate-for-observation" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx<span class="w"> </span><span class="nv">RA_Nom</span><span class="o">=</span><span class="m">254</span>.47042153578<span class="w"> </span><span class="nv">Dec_Nom</span><span class="o">=</span><span class="m">35</span>.349687440319<span class="w"> </span><span class="nv">Roll_Nom</span><span class="o">=</span><span class="m">207</span>.24753234529<span class="w"> </span><span class="nv">GratingType</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">ExposureTime</span><span class="o">=</span><span class="m">51150</span>.833339989185<span class="w"> </span><span class="nv">DitherModel</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">DitherFile</span><span class="o">=</span>download/3662/primary/pcadf141954141N003_asol1.fits<span class="w"> </span><span class="nv">TStart</span><span class="o">=</span><span class="m">141954141</span>.91872<span class="w"> </span><span class="nv">ACIS_Exposure_Time</span><span class="o">=</span><span class="m">3</span>.1<span class="w"> </span><span class="nv">SourceRA</span><span class="o">=</span><span class="m">254</span>.457583<span class="w"> </span><span class="nv">SourceDEC</span><span class="o">=</span><span class="m">35</span>.342433<span class="w"> </span><span class="nv">DetectorType</span><span class="o">=</span>ACIS-S<span class="w"> </span><span class="nv">DetOffsetX</span><span class="o">=</span><span class="m">0</span>.0014449422646707344<span class="w"> </span><span class="nv">DetOffsetZ</span><span class="o">=</span>-8.777474717742791<span class="w"> </span><span class="nv">SpectrumType</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">SpectrumFile</span><span class="o">=</span>input_spec_marx.tbl<span class="w"> </span><span class="nv">OutputDir</span><span class="o">=</span>marx_only<span class="w"> </span><span class="nv">SourceFlux</span><span class="o">=</span>-1
</pre></div>
</div>
</section>
<section id="marx2fits-use-the-edser-subpixel-algorithm">
<h2>marx2fits : Use the EDSER subpixel algorithm<a class="headerlink" href="#marx2fits-use-the-edser-subpixel-algorithm" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>EDSER<span class="w"> </span>marx_only<span class="w"> </span>marx_only.fits
</pre></div>
</div>
</section>
<section id="lua-input-for-saotrace-saotrace-input-matching-observation">
<h2>Lua input for SAOTrace : <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> input matching observation<a class="headerlink" href="#lua-input-for-saotrace-saotrace-input-matching-observation" title="Link to this heading">¶</a></h2>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">ra_pnt</span> <span class="o">=</span> <span class="mf">254.47042153578</span>
<span class="n">dec_pnt</span> <span class="o">=</span> <span class="mf">35.349687440319</span>
<span class="n">roll_pnt</span> <span class="o">=</span> <span class="mf">207.24753234529</span>

<span class="n">dither_asol_chandra</span><span class="p">{</span> <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;/melkor/d1/guenther/marx/test/testexp55/Wings/download/3662/primary/pcadf141954141N003_asol1.fits&quot;</span><span class="p">,</span>
                     <span class="n">ra</span> <span class="o">=</span> <span class="n">ra_pnt</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">dec_pnt</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="n">roll_pnt</span> <span class="p">}</span>

<span class="n">point</span><span class="p">{</span> <span class="n">position</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ra</span> <span class="o">=</span> <span class="mf">254.457583</span><span class="p">,</span>
          <span class="n">dec</span> <span class="o">=</span> <span class="mf">35.342433</span><span class="p">,</span>
          <span class="n">ra_aimpt</span> <span class="o">=</span> <span class="n">ra_pnt</span><span class="p">,</span>
          <span class="n">dec_aimpt</span> <span class="o">=</span> <span class="n">dec_pnt</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="n">spectrum</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;input_spec_saotrace.rdb&quot;</span><span class="p">,</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;photons/s/cm2&quot;</span><span class="p">,</span>
                      <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;rdb&quot;</span><span class="p">,</span>
                      <span class="n">emin</span> <span class="o">=</span> <span class="s2">&quot;ENERG_LO&quot;</span><span class="p">,</span>
                      <span class="n">emax</span> <span class="o">=</span> <span class="s2">&quot;ENERG_HI&quot;</span><span class="p">,</span>
                      <span class="n">flux</span> <span class="o">=</span> <span class="s2">&quot;FLUX&quot;</span><span class="p">}</span> <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>SAOTrace :<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>CXO time numbers are large and round-off error can appear
which make <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> fail.
Therefore, shorten all times by about 0.01 sec to make sure.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>trace-nest<span class="w"> </span><span class="nv">tag</span><span class="o">=</span>saotrace<span class="w"> </span><span class="nv">srcpars</span><span class="o">=</span>saotrace_source.lua<span class="w"> </span><span class="nv">tstart</span><span class="o">=</span><span class="m">141954141</span>.92872<span class="w">  </span><span class="nv">limit</span><span class="o">=</span><span class="m">51150</span>.81333998919<span class="w"> </span><span class="nv">limit_type</span><span class="o">=</span>sec
</pre></div>
</div>
</section>
<section id="marx-run-marx-with-saotrace-ray-file-as-input">
<h2>marx : Run <strong>marx</strong> with <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> ray file as input<a class="headerlink" href="#marx-run-marx-with-saotrace-ray-file-as-input" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx<span class="w"> </span><span class="nv">RA_Nom</span><span class="o">=</span><span class="m">254</span>.47042153578<span class="w"> </span><span class="nv">Dec_Nom</span><span class="o">=</span><span class="m">35</span>.349687440319<span class="w"> </span><span class="nv">Roll_Nom</span><span class="o">=</span><span class="m">207</span>.24753234529<span class="w"> </span><span class="nv">GratingType</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">ExposureTime</span><span class="o">=</span><span class="m">51150</span>.833339989185<span class="w"> </span><span class="nv">DitherModel</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">DitherFile</span><span class="o">=</span>download/3662/primary/pcadf141954141N003_asol1.fits<span class="w"> </span><span class="nv">TStart</span><span class="o">=</span><span class="m">141954141</span>.91872<span class="w"> </span><span class="nv">ACIS_Exposure_Time</span><span class="o">=</span><span class="m">3</span>.1<span class="w"> </span><span class="nv">SourceRA</span><span class="o">=</span><span class="m">254</span>.457583<span class="w"> </span><span class="nv">SourceDEC</span><span class="o">=</span><span class="m">35</span>.342433<span class="w"> </span><span class="nv">DetectorType</span><span class="o">=</span>ACIS-S<span class="w"> </span><span class="nv">DetOffsetX</span><span class="o">=</span><span class="m">0</span>.0014449422646707344<span class="w"> </span><span class="nv">DetOffsetZ</span><span class="o">=</span>-8.777474717742791<span class="w"> </span><span class="nv">SpectrumType</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">SpectrumFile</span><span class="o">=</span>input_spec_marx.tbl<span class="w"> </span><span class="nv">OutputDir</span><span class="o">=</span>marx_saotrace<span class="w"> </span><span class="nv">SourceType</span><span class="o">=</span>SAOSAC<span class="w"> </span><span class="nv">SAOSACFile</span><span class="o">=</span>saotrace.fits<span class="w"> </span><span class="nv">SourceFlux</span><span class="o">=</span>-1
</pre></div>
</div>
</section>
<section id="marx2fits-same-setting-as-above-for-comparison">
<h2>marx2fits : Same setting as above for comparison<a class="headerlink" href="#marx2fits-same-setting-as-above-for-comparison" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>EDSER<span class="w"> </span>marx_saotrace<span class="w"> </span>marx_saotrace.fits
</pre></div>
</div>
</section>
<section id="ciao-make-image-and-run-cell-detect-to-find-exclusion-regions-for-extraction">
<h2>CIAO : Make image and run cell detect to find exclusion regions for extraction.<a class="headerlink" href="#ciao-make-image-and-run-cell-detect-to-find-exclusion-regions-for-extraction" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dmcopy<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[bin x=3700:4300:1,y=3700:4300:1][opt type=i4]&quot;</span><span class="w"> </span>im.fits<span class="w"> </span><span class="nv">option</span><span class="o">=</span>image<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkpsfmap<span class="w"> </span>im.fits<span class="w"> </span>psf.map<span class="w"> </span><span class="m">1</span>.4<span class="w"> </span><span class="nv">ecf</span><span class="o">=</span><span class="m">0</span>.5
celldetect<span class="w"> </span>im.fits<span class="w"> </span>im_src.fits<span class="w"> </span><span class="nv">psffile</span><span class="o">=</span>psf.map<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
asphist<span class="w"> </span>download/3662/primary/pcadf141954141N003_asol1.fits<span class="w"> </span>asphist_7.fits<span class="w"> </span><span class="nv">evtfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[ccd_id=7]&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
</pre></div>
</div>
</section>
<section id="ciao-create-exposure-maps">
<h2>CIAO : Create exposure maps<a class="headerlink" href="#ciao-create-exposure-maps" title="Link to this heading">¶</a></h2>
<p>Also, make exposure map for S-3 chip to correct for dither etc. Mirror effective
area is not included in that calculation, because all the photons we care for come
from the same source, not from different positions on the sky, thus the mirror
effective area is the constant for the source we look at.</p>
<p>The instrument map depends strongly on the energy. We will thus pass in the
source spectrum. This gives us one map appropriately scaled for the whole spectrum.
However, in later analysis, we want to split the data in narrower bands.
When looking at that accurately, we need to have one map for each band.</p>
<p>Also, the observed data contains bad pixels, while the marx simulated data does not.
This means that we need to make a second set of maps with no bad pixels in them.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkinstmap<span class="w"> </span>instmap_0.4.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.45<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.4.fits<span class="w"> </span>instmap_0.4.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.4_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.45<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.4_marx.fits<span class="w"> </span>instmap_0.4_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.55<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.5.fits<span class="w"> </span>instmap_0.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.55<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.5_marx.fits<span class="w"> </span>instmap_0.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.6.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.6499999999999999<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.6.fits<span class="w"> </span>instmap_0.6.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.6_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.6499999999999999<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.6_marx.fits<span class="w"> </span>instmap_0.6_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.7.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.8<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.7.fits<span class="w"> </span>instmap_0.7.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.7_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.8<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.7_marx.fits<span class="w"> </span>instmap_0.7_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.9.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.95<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.9.fits<span class="w"> </span>instmap_0.9.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_0.9_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">0</span>.95<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_0.9_marx.fits<span class="w"> </span>instmap_0.9_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.1<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.0.fits<span class="w"> </span>instmap_1.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.1<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.0_marx.fits<span class="w"> </span>instmap_1.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.2.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.2999999999999998<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.2.fits<span class="w"> </span>instmap_1.2.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.2_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.2999999999999998<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.2_marx.fits<span class="w"> </span>instmap_1.2_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.4.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.5<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.4.fits<span class="w"> </span>instmap_1.4.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.4_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.5<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.4_marx.fits<span class="w"> </span>instmap_1.4_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.6.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.7000000000000002<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.6.fits<span class="w"> </span>instmap_1.6.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.6_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.7000000000000002<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.6_marx.fits<span class="w"> </span>instmap_1.6_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.8.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.9<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.8.fits<span class="w"> </span>instmap_1.8.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_1.8_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">1</span>.9<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_1.8_marx.fits<span class="w"> </span>instmap_1.8_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.1<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.0.fits<span class="w"> </span>instmap_2.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.1<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.0_marx.fits<span class="w"> </span>instmap_2.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.2.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.3<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.2.fits<span class="w"> </span>instmap_2.2.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.2_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.3<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.2_marx.fits<span class="w"> </span>instmap_2.2_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.4.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.5<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.4.fits<span class="w"> </span>instmap_2.4.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.4_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.5<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.4_marx.fits<span class="w"> </span>instmap_2.4_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.6.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.7<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.6.fits<span class="w"> </span>instmap_2.6.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.6_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.7<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.6_marx.fits<span class="w"> </span>instmap_2.6_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.8.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.9<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.8.fits<span class="w"> </span>instmap_2.8.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_2.8_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">2</span>.9<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_2.8_marx.fits<span class="w"> </span>instmap_2.8_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_3.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">3</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_3.0.fits<span class="w"> </span>instmap_3.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_3.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">3</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_3.0_marx.fits<span class="w"> </span>instmap_3.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_3.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">3</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_3.5.fits<span class="w"> </span>instmap_3.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_3.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">3</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_3.5_marx.fits<span class="w"> </span>instmap_3.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_4.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">4</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_4.0.fits<span class="w"> </span>instmap_4.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_4.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">4</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_4.0_marx.fits<span class="w"> </span>instmap_4.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_4.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">4</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_4.5.fits<span class="w"> </span>instmap_4.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_4.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">4</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_4.5_marx.fits<span class="w"> </span>instmap_4.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_5.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">5</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_5.0.fits<span class="w"> </span>instmap_5.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_5.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">5</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_5.0_marx.fits<span class="w"> </span>instmap_5.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_5.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">5</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_5.5.fits<span class="w"> </span>instmap_5.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_5.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">5</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_5.5_marx.fits<span class="w"> </span>instmap_5.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_6.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">6</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_6.0.fits<span class="w"> </span>instmap_6.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_6.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">6</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_6.0_marx.fits<span class="w"> </span>instmap_6.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_6.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">6</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_6.5.fits<span class="w"> </span>instmap_6.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_6.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">6</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_6.5_marx.fits<span class="w"> </span>instmap_6.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_7.0.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">7</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_7.0.fits<span class="w"> </span>instmap_7.0.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_7.0_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">7</span>.25<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_7.0_marx.fits<span class="w"> </span>instmap_7.0_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_7.5.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">7</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_7.5.fits<span class="w"> </span>instmap_7.5.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
mkinstmap<span class="w"> </span>instmap_7.5_marx.fits<span class="w"> </span><span class="nv">monoenergy</span><span class="o">=</span><span class="m">7</span>.75<span class="w"> </span><span class="nv">pixelgrid</span><span class="o">=</span><span class="s2">&quot;1:1024:#1024,1:1024:#1024&quot;</span><span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[EVENTS]&quot;</span><span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span><span class="s2">&quot;ACIS-S3;BPMASK=0x00000&quot;</span><span class="w"> </span><span class="nv">mirror</span><span class="o">=</span><span class="s2">&quot;HRMA;AREA=1&quot;</span><span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">spectrumfil</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
mkexpmap<span class="w"> </span>asphist_7.fits<span class="w"> </span>expmap_7.5_marx.fits<span class="w"> </span>instmap_7.5_marx.fits<span class="w"> </span><span class="nv">xygrid</span><span class="o">=</span><span class="s2">&quot;2975:4400:#512,3250:4650:#512&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">useavgaspect</span><span class="o">=</span>no
</pre></div>
</div>
</section>
<section id="python-clean-bogus-sources-from-src-file-and-write-regions">
<h2>Python : Clean bogus sources from src file and write regions<a class="headerlink" href="#python-clean-bogus-sources-from-src-file-and-write-regions" title="Link to this heading">¶</a></h2>
<p>celldetect always detects plenty of sources on the read-out streak and
around the piled-up regions.
For processing speed and clarity we want to remove those bogus detections
from the source list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that this code might not run if you directly copy and paste it:</span>
<span class="c1"># - Not all import statements are shown here</span>
<span class="c1"># - `self` is a reference to a test instance, which allows access to</span>
<span class="c1">#   parameters such as the directory where the test is run etc.</span>

<span class="sd">&#39;&#39;&#39;Clean bogus sources from src file and write regions</span>

<span class="sd">celldetect always detects plenty of sources on the read-out streak and</span>
<span class="sd">around the piled-up regions.</span>
<span class="sd">For processing speed and clarity we want to remove those bogus detections</span>
<span class="sd">from the source list.</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basepath</span><span class="p">,</span> <span class="s1">&#39;im_src.fits&#39;</span><span class="p">),</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Get sources within 50 pix of Her X-1. We don&#39;t look there anyway because of pile-up</span>
<span class="n">src</span><span class="p">[</span><span class="s1">&#39;d_herx1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">src</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
                         <span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">d_src</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;d_herx1&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">50.</span>
<span class="c1"># Get sources on the read-out streak</span>
<span class="c1"># 2 points on streak</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3772.</span><span class="p">,</span> <span class="mf">3264.</span><span class="p">])</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4251.</span><span class="p">,</span> <span class="mf">4193.</span><span class="p">])</span>
<span class="c1"># n is normal to read-out streak</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">src</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]])</span>
<span class="n">d_line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="n">p1</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">2.</span>
<span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="o">~</span><span class="n">d_src</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">d_line</span><span class="p">]</span>

<span class="c1"># box for readout streak</span>
<span class="n">streak</span> <span class="o">=</span> <span class="s1">&#39;rotbox(4010.0285,3725.3416,18.240189,1085.0354,332.74569)&#39;</span>
<span class="c1"># Assemble regions for extraction:</span>
<span class="n">n_rings</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">r_rings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">7.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">500.</span><span class="p">),</span> <span class="n">n_rings</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.492</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basepath</span><span class="p">,</span> <span class="s1">&#39;annuli.stk&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_rings</span><span class="p">):</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="s1">&#39;annulus(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">, </span><span class="si">{3}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                                                   <span class="n">r_rings</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r_rings</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">reg</span> <span class="o">+=</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">streak</span>
        <span class="c1"># find sources that overlap this ring</span>
        <span class="n">ind1</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;d_herx1&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">r_rings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ind2</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;d_herx1&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">src</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">r_rings</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">src_intersect</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">ind1</span> <span class="o">&amp;</span> <span class="n">ind2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">src_intersect</span><span class="p">:</span>
            <span class="n">reg</span> <span class="o">+=</span> <span class="s1">&#39;-ellipse(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">, </span><span class="si">{2}</span><span class="s1">, </span><span class="si">{3}</span><span class="s1">, </span><span class="si">{4}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span>
                                                                <span class="n">s</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                                                                <span class="n">s</span><span class="p">[</span><span class="s1">&#39;ROTANG&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ciao-extract-data-in-energy-bins">
<h2>CIAO : Extract data in energy bins<a class="headerlink" href="#ciao-extract-data-in-energy-bins" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=400.0:500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.4_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.4.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=500.0:600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=600.0:700.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.6_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.6.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=700.0:900.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.7_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.7.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=900.0:1000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.9_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.9.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=1000.0:1200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=1200.0:1400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.2_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.2.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=1400.0:1600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.4_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.4.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=1600.0:1800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.6_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.6.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=1800.0:2000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.8_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.8.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=2000.0:2200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=2200.0:2400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.2_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.2.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=2400.0:2600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.4_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.4.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=2600.0:2800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.6_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.6.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=2800.0:3000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.8_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.8.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=3000.0:3500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=3500.0:4000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=4000.0:4500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=4500.0:5000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=5000.0:5500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=5500.0:6000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=6000.0:6500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=6500.0:7000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=7000.0:7500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.0_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.0.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;download/3662/primary/acisf03662N003_evt2.fits.gz[energy=7500.0:8000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.5_obs.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.5.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=400.0:500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.4_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=500.0:600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=600.0:700.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.6_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=700.0:900.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.7_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.7_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=900.0:1000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.9_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.9_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=1000.0:1200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=1200.0:1400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.2_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.2_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=1400.0:1600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.4_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=1600.0:1800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.6_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=1800.0:2000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.8_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.8_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=2000.0:2200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=2200.0:2400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.2_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.2_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=2400.0:2600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.4_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=2600.0:2800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.6_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=2800.0:3000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.8_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.8_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=3000.0:3500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=3500.0:4000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=4000.0:4500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=4500.0:5000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=5000.0:5500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=5500.0:6000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=6000.0:6500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=6500.0:7000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=7000.0:7500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.0_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_only.fits[energy=7500.0:8000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.5_marx.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=400.0:500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.4_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=500.0:600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=600.0:700.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.6_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=700.0:900.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.7_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.7_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=900.0:1000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_0.9_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_0.9_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=1000.0:1200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=1200.0:1400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.2_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.2_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=1400.0:1600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.4_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=1600.0:1800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.6_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=1800.0:2000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_1.8_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_1.8_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=2000.0:2200.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=2200.0:2400.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.2_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.2_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=2400.0:2600.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.4_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.4_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=2600.0:2800.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.6_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.6_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=2800.0:3000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_2.8_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_2.8_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=3000.0:3500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=3500.0:4000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_3.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_3.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=4000.0:4500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=4500.0:5000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_4.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_4.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=5000.0:5500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=5500.0:6000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_5.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_5.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=6000.0:6500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=6500.0:7000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_6.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_6.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=7000.0:7500.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.0_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.0_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;marx_saotrace.fits[energy=7500.0:8000.0][bin sky=@annuli.stk]&quot;</span><span class="w"> </span>profile_7.5_saotrace.fits<span class="w"> </span><span class="nv">exp</span><span class="o">=</span>expmap_7.5_marx.fits<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic2<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
</pre></div>
</div>
</section>
<section id="python-analyze-and-plot-results-plot-1">
<h2>Python : Analyze and plot results - Plot 1<a class="headerlink" href="#python-analyze-and-plot-results-plot-1" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that this code might not run if you directly copy and paste it:</span>
<span class="c1"># - Not all import statements are shown here</span>
<span class="c1"># - `self` is a reference to a test instance, which allows access to</span>
<span class="c1">#   parameters such as the directory where the test is run etc.</span>

<span class="sd">&#39;&#39;&#39;Analyze and plot results - Plot 1&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">sherpa.data</span> <span class="kn">import</span> <span class="n">Data1D</span>
<span class="kn">from</span> <span class="nn">sherpa.models.basic</span> <span class="kn">import</span> <span class="n">Const1D</span><span class="p">,</span> <span class="n">PowLaw1D</span>
<span class="kn">from</span> <span class="nn">sherpa.stats</span> <span class="kn">import</span> <span class="n">Chi2</span>
<span class="kn">from</span> <span class="nn">sherpa.optmethods</span> <span class="kn">import</span> <span class="n">LevMar</span>
<span class="kn">from</span> <span class="nn">sherpa.fit</span> <span class="kn">import</span> <span class="n">Fit</span>

<span class="c1"># set up Sherpa fitting</span>
<span class="n">const1d</span> <span class="o">=</span> <span class="n">Const1D</span><span class="p">()</span>
<span class="n">const1d</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pow1d</span> <span class="o">=</span> <span class="n">PowLaw1D</span><span class="p">()</span>
<span class="n">stat</span> <span class="o">=</span> <span class="n">Chi2</span><span class="p">()</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LevMar</span><span class="p">()</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">energy_index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">fullname</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;obs&#39;</span><span class="p">:</span> <span class="s1">&#39;Observation&#39;</span><span class="p">,</span> <span class="s1">&#39;marx&#39;</span><span class="p">:</span> <span class="s1">&#39;MARX&#39;</span><span class="p">,</span>
            <span class="s1">&#39;saotrace&#39;</span><span class="p">:</span> <span class="s1">&#39;SAOTrace + MARX&#39;</span><span class="p">}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">energy_index</span><span class="p">)):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">[</span><span class="n">energy_index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
    <span class="n">e_upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">[</span><span class="n">energy_index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="s1">&#39;marx&#39;</span><span class="p">,</span> <span class="s1">&#39;saotrace&#39;</span><span class="p">]):</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;profile_</span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.fits&#39;</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r_arcsec</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="mf">0.492</span>
        <span class="n">indfit</span> <span class="o">=</span> <span class="n">r_arcsec</span> <span class="o">&gt;</span> <span class="mf">15.</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">r_arcsec</span><span class="p">,</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX&#39;</span><span class="p">],</span>
                            <span class="n">yerr</span><span class="o">=</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX_ERR&#39;</span><span class="p">],</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;__no_legend__&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;obs&#39;</span><span class="p">:</span>
            <span class="n">mymod</span> <span class="o">=</span> <span class="n">const1d</span> <span class="o">+</span> <span class="n">pow1d</span>
            <span class="n">const1d</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mymod</span> <span class="o">=</span> <span class="n">pow1d</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">Data1D</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">indfit</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX&#39;</span><span class="p">][</span><span class="n">indfit</span><span class="p">],</span>
                      <span class="n">staterror</span><span class="o">=</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX_ERR&#39;</span><span class="p">][</span><span class="n">indfit</span><span class="p">])</span>
        <span class="n">gfit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mymod</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
        <span class="n">gfit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_arcsec</span><span class="p">,</span> <span class="n">mymod</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">fullname</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:3.1f}</span><span class="s1"> - </span><span class="si">{1:3.1f}</span><span class="s1"> keV&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">e_upper</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;flux per area&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;radius [arcsec]&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figpath</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="python-analyze-and-plot-results-plot-2">
<h2>Python : Analyze and plot results - Plot 2<a class="headerlink" href="#python-analyze-and-plot-results-plot-2" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that this code might not run if you directly copy and paste it:</span>
<span class="c1"># - Not all import statements are shown here</span>
<span class="c1"># - `self` is a reference to a test instance, which allows access to</span>
<span class="c1">#   parameters such as the directory where the test is run etc.</span>

<span class="sd">&#39;&#39;&#39;Analyze and plot results - Plot 2&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">sherpa.data</span> <span class="kn">import</span> <span class="n">Data1D</span>
<span class="kn">from</span> <span class="nn">sherpa.models.basic</span> <span class="kn">import</span> <span class="n">Const1D</span><span class="p">,</span> <span class="n">PowLaw1D</span>
<span class="kn">from</span> <span class="nn">sherpa.stats</span> <span class="kn">import</span> <span class="n">Chi2</span>
<span class="kn">from</span> <span class="nn">sherpa.optmethods</span> <span class="kn">import</span> <span class="n">LevMar</span>
<span class="kn">from</span> <span class="nn">sherpa.fit</span> <span class="kn">import</span> <span class="n">Fit</span>

<span class="c1"># set up Sherpa fitting</span>
<span class="n">const1d</span> <span class="o">=</span> <span class="n">Const1D</span><span class="p">()</span>
<span class="n">const1d</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pow1d</span> <span class="o">=</span> <span class="n">PowLaw1D</span><span class="p">()</span>
<span class="n">stat</span> <span class="o">=</span> <span class="n">Chi2</span><span class="p">()</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">LevMar</span><span class="p">()</span>

<span class="n">slopes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="s1">&#39;marx&#39;</span><span class="p">,</span> <span class="s1">&#39;saotrace&#39;</span><span class="p">]):</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;profile_</span><span class="si">{</span><span class="n">e</span><span class="si">:</span><span class="s1">3.1f</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.fits&#39;</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">r_arcsec</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="mf">0.492</span>
        <span class="n">indfit</span> <span class="o">=</span> <span class="n">r_arcsec</span> <span class="o">&gt;</span> <span class="mf">15.</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;obs&#39;</span><span class="p">:</span>
            <span class="n">mymod</span> <span class="o">=</span> <span class="n">const1d</span> <span class="o">+</span> <span class="n">pow1d</span>
            <span class="n">const1d</span><span class="o">.</span><span class="n">c0</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mymod</span> <span class="o">=</span> <span class="n">pow1d</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">Data1D</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">[</span><span class="n">indfit</span><span class="p">],</span> <span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX&#39;</span><span class="p">][</span><span class="n">indfit</span><span class="p">],</span>
                      <span class="n">staterror</span><span class="o">=</span><span class="n">tab</span><span class="p">[</span><span class="s1">&#39;SUR_FLUX_ERR&#39;</span><span class="p">][</span><span class="n">indfit</span><span class="p">])</span>
        <span class="n">gfit</span> <span class="o">=</span> <span class="n">Fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mymod</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">opt</span><span class="p">)</span>
        <span class="n">gfit</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;obs&#39;</span><span class="p">:</span>
            <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">pow1d</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slopes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">pow1d</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">val</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">gfit</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">e_mid</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;Observation&#39;</span><span class="p">,</span> <span class="s1">&#39;MARX&#39;</span><span class="p">,</span> <span class="s1">&#39;SAOTrace + MARX&#39;</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">e_mid</span><span class="p">,</span> <span class="n">slopes</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;energy [keV]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;slope of powerlaw&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figpath</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">]),</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<form action="../../search.html" method="get">
<input type="text" name="q" placeholder="Search" />
<input type="hidden" name="check_keywords" value="yes" />
<input type="hidden" name="area" value="default" />
</form>
  <h3><a href="../../index.html">Page Content</a></h3>
  <ul>
<li><a class="reference internal" href="#">Wings of the Chandra PSF</a><ul>
<li><a class="reference internal" href="#ciao-obtain-spectrum-from-observed-data">CIAO : Obtain spectrum from observed data</a></li>
<li><a class="reference internal" href="#shell-unzip-fits-file">shell : Unzip fits file.</a></li>
<li><a class="reference internal" href="#marx-set-marx-parameters-appropriate-for-observation">marx : Set marx parameters appropriate for observation</a></li>
<li><a class="reference internal" href="#marx2fits-use-the-edser-subpixel-algorithm">marx2fits : Use the EDSER subpixel algorithm</a></li>
<li><a class="reference internal" href="#lua-input-for-saotrace-saotrace-input-matching-observation">Lua input for SAOTrace : SAOTrace input matching observation</a></li>
<li><a class="reference internal" href="#id1">SAOTrace :</a></li>
<li><a class="reference internal" href="#marx-run-marx-with-saotrace-ray-file-as-input">marx : Run <strong>marx</strong> with SAOTrace ray file as input</a></li>
<li><a class="reference internal" href="#marx2fits-same-setting-as-above-for-comparison">marx2fits : Same setting as above for comparison</a></li>
<li><a class="reference internal" href="#ciao-make-image-and-run-cell-detect-to-find-exclusion-regions-for-extraction">CIAO : Make image and run cell detect to find exclusion regions for extraction.</a></li>
<li><a class="reference internal" href="#ciao-create-exposure-maps">CIAO : Create exposure maps</a></li>
<li><a class="reference internal" href="#python-clean-bogus-sources-from-src-file-and-write-regions">Python : Clean bogus sources from src file and write regions</a></li>
<li><a class="reference internal" href="#ciao-extract-data-in-energy-bins">CIAO : Extract data in energy bins</a></li>
<li><a class="reference internal" href="#python-analyze-and-plot-results-plot-1">Python : Analyze and plot results - Plot 1</a></li>
<li><a class="reference internal" href="#python-analyze-and-plot-results-plot-2">Python : Analyze and plot results - Plot 2</a></li>
</ul>
</li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="OffAxisPSF.html"
                          title="previous chapter">Off-axis PSF</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="CompMARXSAOTraceenergies.html"
                          title="next chapter">On-axis PSF at different energies</a></p>
  </div><hr style="color: #FFF;"></hr>
<a href="http://cxc.harvard.edu/">
    <img src="../../_static/cxcfooterCXCicon.png" 
	 alt="Chandra X-ray Center" class="img-logo"></img>
</a>
<p></p>
<a href="http://space.mit.edu/cxc/">CXC@MIT</a>
<p></p>
<a href="http://space.mit.edu/">
    <img src="../../_static/logo-mit-kavli.png" 
	 alt="MIT Kavli Institute" class="img-logo"></img>
</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../std-parindex.html" title="MARX Parameter Index"
             >MARX Parameters</a> |</li>
        <li class="right" >
          <a href="CompMARXSAOTraceenergies.html" title="On-axis PSF at different energies"
             >next</a> |</li>
        <li class="right" >
          <a href="OffAxisPSF.html" title="Off-axis PSF"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MARX 5.5.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><strong>marx</strong> accuracy and testing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../listofcode.html" >List of code used to run tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Wings of the Chandra PSF</a></li> 
      </ul>
    </div>
    <div class="footer">
    <a href="mailto:marx-help@space.mit.edu">MARX support: marx-help@space.mit.edu</a>
    <a href="https://accessibility.mit.edu/">Accessibility</a>
        &copy; Copyright 2002-2023, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>