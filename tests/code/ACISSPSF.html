<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>On-axis PSF on an ACIS-BI chip &#8212; MARX 5.5.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/marxwebtheme.css?v=c47e7066" />
    
    <script src="../../_static/documentation_options.js?v=947d29b4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MARX 5.5.3 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="On-axis PSF on an ACIS-FI chip" href="ACISIPSF.html" />
    <link rel="prev" title="List of code used to run tests" href="../listofcode.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../std-parindex.html" title="MARX Parameter Index"
             >MARX Parameters</a> |</li>
        <li class="right" >
          <a href="ACISIPSF.html" title="On-axis PSF on an ACIS-FI chip"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../listofcode.html" title="List of code used to run tests"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MARX 5.5.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><strong>marx</strong> accuracy and testing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../listofcode.html" accesskey="U">List of code used to run tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">On-axis PSF on an ACIS-BI chip</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following shows the code used to run this <strong>marx</strong> test. You can inspect
it and adapt it to your needs, but you cannot copy and paste it directly
because it depends on local <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> and other environment variables.
For example, we use a python function to manage the directory structure
for all the images generated by all the tests instead of giving the file
name directly to save images.</p>
</div>
<section id="on-axis-psf-on-an-acis-bi-chip">
<span id="test-code-acisspsf"></span><h1>On-axis PSF on an ACIS-BI chip<a class="headerlink" href="#on-axis-psf-on-an-acis-bi-chip" title="Link to this heading">¶</a></h1>
<section id="ciao-obtain-spectrum-from-observed-data">
<h2>CIAO : Obtain spectrum from observed data<a class="headerlink" href="#ciao-obtain-spectrum-from-observed-data" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>asphist<span class="w"> </span><span class="nv">infile</span><span class="o">=</span>download/15713/primary/pcadf508966864N002_asol1.fits<span class="w"> </span><span class="nv">outfile</span><span class="o">=</span>obs.asp<span class="w"> </span><span class="nv">evtfile</span><span class="o">=</span>download/15713/primary/acisf15713N002_evt2.fits.gz<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
<span class="c1"># It would be more accuarte to use mkwarf.</span>
<span class="c1"># However, that&#39;s slower and for our purposes an approximate solution is good enough.</span>
mkarf<span class="w"> </span><span class="nv">detsubsys</span><span class="o">=</span>ACIS-7<span class="w"> </span><span class="nv">grating</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">outfile</span><span class="o">=</span>obs.arf<span class="w"> </span><span class="nv">obsfile</span><span class="o">=</span>download/15713/primary/acisf15713N002_evt2.fits.gz<span class="w"> </span><span class="nv">asphistfile</span><span class="o">=</span>obs.asp<span class="w"> </span><span class="nv">sourcepixelx</span><span class="o">=</span><span class="m">4096</span><span class="w"> </span><span class="nv">sourcepixely</span><span class="o">=</span><span class="m">4074</span><span class="w"> </span><span class="nv">engrid</span><span class="o">=</span><span class="s2">&quot;0.3:8.0:0.1&quot;</span><span class="w"> </span><span class="nv">maskfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">pbkfile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">dafile</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">verbose</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="nv">mode</span><span class="o">=</span>h<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># We have to use the same energy binning in energy space here that we used for the arf!</span>
<span class="c1"># So, first convert the PI to energy (to a precision that&#39;s good enough).</span>
dmtcalc<span class="w"> </span><span class="s2">&quot;download/15713/primary/acisf15713N002_evt2.fits.gz[EVENTS][sky=circle(4096, 4074, 4)]&quot;</span><span class="w"> </span>evt2_with_energy.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;energy=(float)pi*0.0149&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmextract<span class="w"> </span><span class="s2">&quot;evt2_with_energy.fits[bin energy=.3:7.999:0.1]&quot;</span><span class="w"> </span>obs.spec<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes<span class="w"> </span><span class="nv">opt</span><span class="o">=</span>generic
dmcopy<span class="w"> </span><span class="s2">&quot;obs.arf[cols energ_lo,energ_hi,specresp]&quot;</span><span class="w"> </span>input_spec.fits<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmpaste<span class="w"> </span>input_spec.fits<span class="w"> </span><span class="s2">&quot;obs.spec[cols counts]&quot;</span><span class="w"> </span>input_spec_1.fits<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmtcalc<span class="w"> </span>input_spec_1.fits<span class="w"> </span>input_spec_2.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;flux=counts/((float)specresp * 1*11543.550629973412)&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># devide by binwidth to turn the flux into a flux DENSITY for marx</span>
dmtcalc<span class="w"> </span>input_spec_2.fits<span class="w"> </span>input_spec_3.fits<span class="w">  </span><span class="nv">expr</span><span class="o">=</span><span class="s2">&quot;fluxdens=flux/0.1&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmcopy<span class="w"> </span><span class="s2">&quot;input_spec_3.fits[cols energ_hi,fluxdens]&quot;</span><span class="w"> </span><span class="s2">&quot;input_spec_marx.tbl[opt kernel=text/simple]&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
dmcopy<span class="w"> </span><span class="s2">&quot;input_spec_3.fits[cols energ_lo,energ_hi,flux]&quot;</span><span class="w"> </span><span class="s2">&quot;input_spec_saotrace.tbl[opt kernel=text/simple]&quot;</span><span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes

<span class="c1"># We now use a combination of some of the most obscure UNIX tools to</span>
<span class="c1"># bring the SAOTRACE input spectrum into the right format</span>
<span class="c1"># see http://cxc.harvard.edu/cal/Hrma/RDB/FileFormat.html</span>

<span class="c1"># Remove the leading &quot;#&quot; from the line with the column names</span>
awk<span class="w"> </span><span class="s1">&#39;{ sub(/\# ENERG_LO/,&quot;ENERG_LO&quot;); print }&#39;</span><span class="w"> </span>&lt;<span class="w"> </span>input_spec_saotrace.tbl<span class="w"> </span>&gt;<span class="w"> </span>input_spec_saotrace.temp
<span class="c1"># Then, replace spaces with tabs</span>
tr<span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="se">\\</span>t<span class="w"> </span>&lt;<span class="w"> </span>input_spec_saotrace.temp<span class="w"> </span>&gt;<span class="w"> </span>input_spec_saotrace.rdb
</pre></div>
</div>
</section>
<section id="shell-unzip-fits-file">
<h2>shell : Unzip fits file.<a class="headerlink" href="#shell-unzip-fits-file" title="Link to this heading">¶</a></h2>
<p>MARX cannot read zipped fits files, so we need to unzip the .fits.gz asol
files that we downloaded from the archive. On the other hand, <a class="reference external" href="http://cxc.harvard.edu/ciao/">CIAO</a>
tools work on both zipped or unzipped files, so there is no need to
unzip all of them, just the files that MARX reads as input.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>gunzip<span class="w"> </span>-f<span class="w"> </span>download/15713/primary/pcadf508966864N002_asol1.fits
</pre></div>
</div>
</section>
<section id="marx-set-marx-parameters-appropriate-for-observation">
<h2>marx : Set marx parameters appropriate for observation<a class="headerlink" href="#marx-set-marx-parameters-appropriate-for-observation" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx<span class="w"> </span><span class="nv">RA_Nom</span><span class="o">=</span><span class="m">182</span>.25909891372<span class="w"> </span><span class="nv">Dec_Nom</span><span class="o">=</span>-51.341662012085<span class="w"> </span><span class="nv">Roll_Nom</span><span class="o">=</span><span class="m">33</span>.972028259258<span class="w"> </span><span class="nv">GratingType</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">ExposureTime</span><span class="o">=</span><span class="m">10190</span>.806809961796<span class="w"> </span><span class="nv">DitherModel</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">DitherFile</span><span class="o">=</span>download/15713/primary/pcadf508966864N002_asol1.fits<span class="w"> </span><span class="nv">TStart</span><span class="o">=</span><span class="m">508966864</span>.84771<span class="w"> </span><span class="nv">ACIS_Exposure_Time</span><span class="o">=</span><span class="m">0</span>.7<span class="w"> </span><span class="nv">SourceRA</span><span class="o">=</span><span class="m">182</span>.259167<span class="w"> </span><span class="nv">SourceDEC</span><span class="o">=</span>-51.344667<span class="w"> </span><span class="nv">DetectorType</span><span class="o">=</span>ACIS-S<span class="w"> </span><span class="nv">DetOffsetX</span><span class="o">=</span><span class="m">0</span>.0014449422646707344<span class="w"> </span><span class="nv">DetOffsetZ</span><span class="o">=</span>-0.007542945902798692<span class="w"> </span><span class="nv">SpectrumType</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">SpectrumFile</span><span class="o">=</span>input_spec_marx.tbl<span class="w"> </span><span class="nv">OutputDir</span><span class="o">=</span>marx_only<span class="w"> </span><span class="nv">SourceFlux</span><span class="o">=</span>-1
</pre></div>
</div>
</section>
<section id="marx2fits-use-the-edser-subpixel-algorithm">
<h2>marx2fits : Use the EDSER subpixel algorithm<a class="headerlink" href="#marx2fits-use-the-edser-subpixel-algorithm" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>EDSER<span class="w"> </span>marx_only<span class="w"> </span>marx_only.fits
</pre></div>
</div>
</section>
<section id="lua-input-for-saotrace-saotrace-input-matching-observation">
<h2>Lua input for SAOTrace : <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> input matching observation<a class="headerlink" href="#lua-input-for-saotrace-saotrace-input-matching-observation" title="Link to this heading">¶</a></h2>
<div class="highlight-lua notranslate"><div class="highlight"><pre><span></span><span class="n">ra_pnt</span> <span class="o">=</span> <span class="mf">182.25909891372</span>
<span class="n">dec_pnt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">51.341662012085</span>
<span class="n">roll_pnt</span> <span class="o">=</span> <span class="mf">33.972028259258</span>

<span class="n">dither_asol_chandra</span><span class="p">{</span> <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;/melkor/d1/guenther/marx/test/testexp55/ACISSPSF/download/15713/primary/pcadf508966864N002_asol1.fits&quot;</span><span class="p">,</span>
                     <span class="n">ra</span> <span class="o">=</span> <span class="n">ra_pnt</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">dec_pnt</span><span class="p">,</span> <span class="n">roll</span> <span class="o">=</span> <span class="n">roll_pnt</span> <span class="p">}</span>

<span class="n">point</span><span class="p">{</span> <span class="n">position</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ra</span> <span class="o">=</span> <span class="mf">182.259167</span><span class="p">,</span>
          <span class="n">dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">51.344667</span><span class="p">,</span>
          <span class="n">ra_aimpt</span> <span class="o">=</span> <span class="n">ra_pnt</span><span class="p">,</span>
          <span class="n">dec_aimpt</span> <span class="o">=</span> <span class="n">dec_pnt</span><span class="p">,</span>
       <span class="p">},</span>
       <span class="n">spectrum</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span> <span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;input_spec_saotrace.rdb&quot;</span><span class="p">,</span>
                      <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;photons/s/cm2&quot;</span><span class="p">,</span>
                      <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                      <span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;rdb&quot;</span><span class="p">,</span>
                      <span class="n">emin</span> <span class="o">=</span> <span class="s2">&quot;ENERG_LO&quot;</span><span class="p">,</span>
                      <span class="n">emax</span> <span class="o">=</span> <span class="s2">&quot;ENERG_HI&quot;</span><span class="p">,</span>
                      <span class="n">flux</span> <span class="o">=</span> <span class="s2">&quot;FLUX&quot;</span><span class="p">}</span> <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>SAOTrace :<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>CXO time numbers are large and round-off error can appear
which make <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> fail.
Therefore, shorten all times by about 0.01 sec to make sure.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>trace-nest<span class="w"> </span><span class="nv">tag</span><span class="o">=</span>saotrace<span class="w"> </span><span class="nv">srcpars</span><span class="o">=</span>saotrace_source.lua<span class="w"> </span><span class="nv">tstart</span><span class="o">=</span><span class="m">508966864</span>.85771<span class="w">  </span><span class="nv">limit</span><span class="o">=</span><span class="m">10190</span>.786809961795<span class="w"> </span><span class="nv">limit_type</span><span class="o">=</span>sec
</pre></div>
</div>
</section>
<section id="marx-run-marx-with-saotrace-ray-file-as-input">
<h2>marx : Run <strong>marx</strong> with <a class="reference external" href="http://cxc.harvard.edu/cal/Hrma/SAOTrace.html">SAOTrace</a> ray file as input<a class="headerlink" href="#marx-run-marx-with-saotrace-ray-file-as-input" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx<span class="w"> </span><span class="nv">RA_Nom</span><span class="o">=</span><span class="m">182</span>.25909891372<span class="w"> </span><span class="nv">Dec_Nom</span><span class="o">=</span>-51.341662012085<span class="w"> </span><span class="nv">Roll_Nom</span><span class="o">=</span><span class="m">33</span>.972028259258<span class="w"> </span><span class="nv">GratingType</span><span class="o">=</span>NONE<span class="w"> </span><span class="nv">ExposureTime</span><span class="o">=</span><span class="m">10190</span>.806809961796<span class="w"> </span><span class="nv">DitherModel</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">DitherFile</span><span class="o">=</span>download/15713/primary/pcadf508966864N002_asol1.fits<span class="w"> </span><span class="nv">TStart</span><span class="o">=</span><span class="m">508966864</span>.84771<span class="w"> </span><span class="nv">ACIS_Exposure_Time</span><span class="o">=</span><span class="m">0</span>.7<span class="w"> </span><span class="nv">SourceRA</span><span class="o">=</span><span class="m">182</span>.259167<span class="w"> </span><span class="nv">SourceDEC</span><span class="o">=</span>-51.344667<span class="w"> </span><span class="nv">DetectorType</span><span class="o">=</span>ACIS-S<span class="w"> </span><span class="nv">DetOffsetX</span><span class="o">=</span><span class="m">0</span>.0014449422646707344<span class="w"> </span><span class="nv">DetOffsetZ</span><span class="o">=</span>-0.007542945902798692<span class="w"> </span><span class="nv">SpectrumType</span><span class="o">=</span>FILE<span class="w"> </span><span class="nv">SpectrumFile</span><span class="o">=</span>input_spec_marx.tbl<span class="w"> </span><span class="nv">OutputDir</span><span class="o">=</span>marx_saotrace<span class="w"> </span><span class="nv">SourceType</span><span class="o">=</span>SAOSAC<span class="w"> </span><span class="nv">SAOSACFile</span><span class="o">=</span>saotrace.fits<span class="w"> </span><span class="nv">SourceFlux</span><span class="o">=</span>-1
</pre></div>
</div>
</section>
<section id="marx2fits-same-setting-as-above-for-comparison">
<h2>marx2fits : Same setting as above for comparison<a class="headerlink" href="#marx2fits-same-setting-as-above-for-comparison" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>EDSER<span class="w"> </span>marx_saotrace<span class="w"> </span>marx_saotrace.fits
</pre></div>
</div>
</section>
<section id="marx2fits-use-randomize-as-an-alternative-to-edser">
<h2>marx2fits : USE RANDOMIZE as an alternative to EDSER<a class="headerlink" href="#marx2fits-use-randomize-as-an-alternative-to-edser" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>RANDOMIZE<span class="w"> </span>marx_only<span class="w"> </span>marx_only_rand.fits
</pre></div>
</div>
</section>
<section id="marx2fits-again-same-setting-as-above">
<h2>marx2fits : Again, same setting as above<a class="headerlink" href="#marx2fits-again-same-setting-as-above" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>marx2fits<span class="w"> </span>--pixadj<span class="o">=</span>RANDOMIZE<span class="w"> </span>marx_saotrace<span class="w"> </span>marx_saotrace_rand.fits
</pre></div>
</div>
</section>
<section id="ciao-reprocess-the-observation-with-randomize">
<h2>CIAO : Reprocess the observation with RANDOMIZE<a class="headerlink" href="#ciao-reprocess-the-observation-with-randomize" title="Link to this heading">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>acis_process_events<span class="w"> </span><span class="nv">infile</span><span class="o">=</span>download/15713/primary/acisf15713N002_evt2.fits.gz<span class="w"> </span><span class="nv">outfile</span><span class="o">=</span>obs_rand.fits<span class="w"> </span><span class="nv">acaofffile</span><span class="o">=</span>download/15713/primary/pcadf508966864N002_asol1.fits<span class="w"> </span><span class="nv">doevtgrade</span><span class="o">=</span>no<span class="w"> </span><span class="nv">calculate_pi</span><span class="o">=</span>no<span class="w"> </span><span class="nv">pix_adj</span><span class="o">=</span>RANDOMIZE<span class="w"> </span><span class="nv">clobber</span><span class="o">=</span>yes
</pre></div>
</div>
</section>
<section id="python-compare-radial-event-distributions">
<h2>Python : Compare radial event distributions<a class="headerlink" href="#python-compare-radial-event-distributions" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that this code might not run if you directly copy and paste it:</span>
<span class="c1"># - Not all import statements are shown here</span>
<span class="c1"># - `self` is a reference to a test instance, which allows access to</span>
<span class="c1">#   parameters such as the directory where the test is run etc.</span>

<span class="k">def</span> <span class="nf">radial_distribution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Calculate the radial distance from the mean position for events.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : np.array</span>
<span class="sd">        x and y coordinates of events</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    r : np.array</span>
<span class="sd">        radial distance from mean position of the events.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">centx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">astropy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">centy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">astropy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">centx</span><span class="p">,</span> <span class="n">centy</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">filter_events</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="n">circle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;A simple event filter function.</span>

<span class="sd">    The parameters offer several filters, it set to ``None`` a filter is not</span>
<span class="sd">    applied.</span>
<span class="sd">    This simple function does not duplicate the entire :ciao:`dm` syntax, only</span>
<span class="sd">    a few simple filters useful for plotting in pure-python functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    evt : `astropy.table.Table`</span>
<span class="sd">        Event table</span>
<span class="sd">    circle : tuple or ``None``</span>
<span class="sd">        Tuple of the form (x, y, r) where (x, y) is the center of</span>
<span class="sd">        a circle and r the radius. All number are in detector coordinates.</span>
<span class="sd">    energy : tuple or ``None``</span>
<span class="sd">        Tuple of the form (lower, upper) with all energies in eV.</span>
<span class="sd">    time : tuple or ``None``</span>
<span class="sd">        Tuple of the form (star, end) with all times in seconds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    evt_filt : ~astropy.table.Table`</span>
<span class="sd">        Filtered event list</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">circle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">cc</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">circle</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">cc</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">circle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">indcirc</span> <span class="o">=</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="n">circle</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indcirc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evt</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">en</span> <span class="o">=</span> <span class="n">cc</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="s1">&#39;energy&#39;</span><span class="p">)</span>
        <span class="n">inden</span> <span class="o">=</span> <span class="p">(</span><span class="n">en</span> <span class="o">&gt;</span> <span class="n">energy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">en</span> <span class="o">&lt;</span> <span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">indcirc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">cc</span><span class="p">(</span><span class="n">evt</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">indt</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">indt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">indcirc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">evt</span><span class="p">[</span><span class="n">indcirc</span> <span class="o">&amp;</span> <span class="n">inden</span> <span class="o">&amp;</span> <span class="n">indt</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">plot_ecf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">filterargs</span><span class="p">,</span> <span class="n">bgfilterargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib axes</span>
<span class="sd">        Axes where the plot will be placed</span>
<span class="sd">    file : list</span>
<span class="sd">        List of three strings with filename for observations,</span>
<span class="sd">        Marx simulation, and SAOTRace + marx simulation</span>
<span class="sd">    filterargs : dict</span>
<span class="sd">        See ``filter_events`` for details</span>
<span class="sd">    bgfilterargs : dict</span>
<span class="sd">        Select a background region (same size, no automatic scaling)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    err_marx : float</span>
<span class="sd">        Flux error if the MARX simulated PSF is assumed to be right.</span>
<span class="sd">        This is calculated as follows: We find the radius that encircles 90% of</span>
<span class="sd">        all counts in the MARX simulation. Then, we extract the observed counts</span>
<span class="sd">        using that radius. If the simulation is correct, that radius should</span>
<span class="sd">        contain 90% of the observed counts, too. If, e.g. the simulated radius</span>
<span class="sd">        is too small, we may extract only 80 % of the counts. The ratio between</span>
<span class="sd">        the two would be 8/9=0.88, meaning that all fluxes extracted using</span>
<span class="sd">        this radius are 12 % too small.</span>
<span class="sd">    err_sao: float</span>
<span class="sd">        Same for the simulation that used SAOTrace + MARX.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># In this energy range we have the most counts and we limited</span>
    <span class="c1"># the simulations to the same range.</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">filter_events</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">**</span><span class="n">filterargs</span><span class="p">)</span>
    <span class="n">bkg</span> <span class="o">=</span> <span class="n">filter_events</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">**</span><span class="n">bgfilterargs</span><span class="p">)</span>
    <span class="n">r_obs</span> <span class="o">=</span> <span class="n">radial_distribution</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">r_obs</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_obs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">bkg</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_obs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_obs</span><span class="p">)),</span>
            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">)</span>

    <span class="n">simmarx</span> <span class="o">=</span> <span class="n">filter_events</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="o">**</span><span class="n">filterargs</span><span class="p">)</span>
    <span class="n">r_marx</span> <span class="o">=</span> <span class="n">radial_distribution</span><span class="p">(</span><span class="n">simmarx</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">simmarx</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>
    <span class="n">r_marx</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_marx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_marx</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MARX&#39;</span><span class="p">)</span>

    <span class="n">simsao</span> <span class="o">=</span> <span class="n">filter_events</span><span class="p">(</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="o">**</span><span class="n">filterargs</span><span class="p">)</span>
    <span class="n">r_sao</span> <span class="o">=</span> <span class="n">radial_distribution</span><span class="p">(</span><span class="n">simsao</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">simsao</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">])</span>
    <span class="n">r_sao</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_sao</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_sao</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SAOTrace + MARX&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;radius [pixel]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;enclosed count fraction&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>

    <span class="n">psf90_marx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">r_marx</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">ecf_at_that_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_obs</span> <span class="o">-</span> <span class="n">psf90_marx</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_obs</span><span class="p">)</span>
    <span class="n">err_marx</span> <span class="o">=</span> <span class="n">ecf_at_that_rad</span> <span class="o">/</span> <span class="mf">0.9</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">psf90_sao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">r_sao</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
    <span class="n">ecf_at_that_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_obs</span> <span class="o">-</span> <span class="n">psf90_sao</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_obs</span><span class="p">)</span>
    <span class="n">err_sao</span> <span class="o">=</span> <span class="n">ecf_at_that_rad</span> <span class="o">/</span> <span class="mf">0.9</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">err_marx</span><span class="p">,</span> <span class="n">err_sao</span>

<span class="sd">&#39;&#39;&#39;Compare radial event distributions&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">filterargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
              <span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                         <span class="mi">5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])</span>
             <span class="p">}</span>
<span class="n">bgfilterargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">3000</span><span class="p">],</span>
                <span class="s1">&#39;circle&#39;</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;bg_x&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;bg_y&#39;</span><span class="p">],</span>
                         <span class="mi">5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])</span>
<span class="p">}</span>

<span class="n">evt2file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_file</span><span class="p">(</span><span class="s1">&#39;evt2&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">],</span>
                            <span class="p">[[</span><span class="n">evt2file</span><span class="p">,</span> <span class="s1">&#39;marx_only.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;marx_saotrace.fits&#39;</span><span class="p">],</span>
                             <span class="p">[</span><span class="s1">&#39;obs_rand.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;marx_only_rand.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;marx_saotrace_rand.fits&#39;</span><span class="p">]],</span>
                            <span class="p">[</span><span class="s1">&#39;EDSER&#39;</span><span class="p">,</span> <span class="s1">&#39;RANDOMIZE&#39;</span><span class="p">]):</span>
    <span class="n">err_marx</span><span class="p">,</span> <span class="n">err_sao</span> <span class="o">=</span> <span class="n">plot_ecf</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">filterargs</span><span class="p">,</span> <span class="n">bgfilterargs</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span> <span class="o">==</span> <span class="s1">&#39;EDSER&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_test_result</span><span class="p">(</span><span class="s1">&#39;marx90&#39;</span><span class="p">,</span> <span class="n">err_marx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_test_result</span><span class="p">(</span><span class="s1">&#39;saotrace90&#39;</span><span class="p">,</span> <span class="n">err_sao</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figpath</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figures</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<form action="../../search.html" method="get">
<input type="text" name="q" placeholder="Search" />
<input type="hidden" name="check_keywords" value="yes" />
<input type="hidden" name="area" value="default" />
</form>
  <h3><a href="../../index.html">Page Content</a></h3>
  <ul>
<li><a class="reference internal" href="#">On-axis PSF on an ACIS-BI chip</a><ul>
<li><a class="reference internal" href="#ciao-obtain-spectrum-from-observed-data">CIAO : Obtain spectrum from observed data</a></li>
<li><a class="reference internal" href="#shell-unzip-fits-file">shell : Unzip fits file.</a></li>
<li><a class="reference internal" href="#marx-set-marx-parameters-appropriate-for-observation">marx : Set marx parameters appropriate for observation</a></li>
<li><a class="reference internal" href="#marx2fits-use-the-edser-subpixel-algorithm">marx2fits : Use the EDSER subpixel algorithm</a></li>
<li><a class="reference internal" href="#lua-input-for-saotrace-saotrace-input-matching-observation">Lua input for SAOTrace : SAOTrace input matching observation</a></li>
<li><a class="reference internal" href="#id1">SAOTrace :</a></li>
<li><a class="reference internal" href="#marx-run-marx-with-saotrace-ray-file-as-input">marx : Run <strong>marx</strong> with SAOTrace ray file as input</a></li>
<li><a class="reference internal" href="#marx2fits-same-setting-as-above-for-comparison">marx2fits : Same setting as above for comparison</a></li>
<li><a class="reference internal" href="#marx2fits-use-randomize-as-an-alternative-to-edser">marx2fits : USE RANDOMIZE as an alternative to EDSER</a></li>
<li><a class="reference internal" href="#marx2fits-again-same-setting-as-above">marx2fits : Again, same setting as above</a></li>
<li><a class="reference internal" href="#ciao-reprocess-the-observation-with-randomize">CIAO : Reprocess the observation with RANDOMIZE</a></li>
<li><a class="reference internal" href="#python-compare-radial-event-distributions">Python : Compare radial event distributions</a></li>
</ul>
</li>
</ul>

  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../listofcode.html"
                          title="previous chapter">List of code used to run tests</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="ACISIPSF.html"
                          title="next chapter">On-axis PSF on an ACIS-FI chip</a></p>
  </div><hr style="color: #FFF;"></hr>
<a href="http://cxc.harvard.edu/">
    <img src="../../_static/cxcfooterCXCicon.png" 
	 alt="Chandra X-ray Center" class="img-logo"></img>
</a>
<p></p>
<a href="http://space.mit.edu/cxc/">CXC@MIT</a>
<p></p>
<a href="http://space.mit.edu/">
    <img src="../../_static/logo-mit-kavli.png" 
	 alt="MIT Kavli Institute" class="img-logo"></img>
</a>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../std-parindex.html" title="MARX Parameter Index"
             >MARX Parameters</a> |</li>
        <li class="right" >
          <a href="ACISIPSF.html" title="On-axis PSF on an ACIS-FI chip"
             >next</a> |</li>
        <li class="right" >
          <a href="../listofcode.html" title="List of code used to run tests"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MARX 5.5.3 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><strong>marx</strong> accuracy and testing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../listofcode.html" >List of code used to run tests</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">On-axis PSF on an ACIS-BI chip</a></li> 
      </ul>
    </div>
    <div class="footer">
    <a href="mailto:marx-help@space.mit.edu">MARX support: marx-help@space.mit.edu</a>
    <a href="https://accessibility.mit.edu/">Accessibility</a>
        &copy; Copyright 2002-2023, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>